<html>
<head>
    <meta charset="utf-8">
    <style type="text/css">
        body {
            background-color: #CCCCCC;
        }
    </style>

    <script>
        function createBase(name, title_name, color, open, close){
            let title = document.createElement('a');
            title.id = name+'_title';
            title.style = 'cursor:pointer; user-select:none;';
            title.textContent = '▼ '+title_name;
            
            let inside = document.createElement('div');
            inside.id = name+'_inside';
            inside.style = 'display:none; clear:both; user-select:none;';
            inside.style.textIndent = '1em';

            title.addEventListener('click',function(){
                if(inside.style.display === 'none'){
                    inside.style.display = 'block';
                    title.textContent = '▲ '+title_name;

                    open(inside);
                }else{
                    inside.style.display = 'none';
                    title.textContent = '▼ '+title_name;
                    
                    close(inside);
                }
            });

            let parent = document.createElement('div');
            parent.id = name;
            parent.style.backgroundColor = color;
            parent.appendChild( title );
            parent.appendChild( inside );

            document.body.appendChild( parent );
        }
    </script>
</head>
<body>

<a href="https://undym.github.io/">前の</a>

<br>
<br>

<!-- trp10 -->
<script>
{   
    
    const MapData = {
        CLICK_START:[
                '',
                '',
                '',
                '',
                '',
                '',
                'C l i c k S t a r t',
                '',
                '',
                '',
                '',
                '',
                '',
        ],
        STAGE_0:[
                '                                ',
                '                                ',
                '                                ',
                '                                ',
                '                                ',
                '                                ',
                '                                ',
                '             *             <|   ',
                '             **             |   ',
                '********************   *****.***',
                '********************   *********',
                '********************************',
        ],
    };
    let init = false;

    let map = [];
    let dom = {
        map_parent:undefined,
        map:undefined,
        ball:undefined,
        ball_charge:undefined,
        clear:undefined,
    };

    let ball = {
        x:0.0,
        y:0.0,
        vec_x:0.0,
        vec_y:0.0,
        moving:false,
        charge:0.0,
        charging:false,
    };

    const BLOCK_SIZE = 8;
    const BALL_CHARGE_MAX = 20.0;

    let start = false;
    let run_timer;


    function resetMapDom(){
        while(dom.map_parent.firstChild){
            dom.map_parent.removeChild( dom.map_parent.firstChild );
        }

        dom.map_parent.appendChild( dom.ball );
    }

    function setMap(map_data){
        resetMapDom();

        map = map_data;

        dom.map = [];
        for(let y = 0; y < map.length; y++){
            let arr = [];
            for(let x = 0; x < map[y].length; x++){
                arr.push( document.createElement('div') );
                arr[x].textContent = map[y].substr(x,1);
                arr[x].style.position = 'absolute';
                arr[x].style.top  = (y * BLOCK_SIZE)+'px';
                arr[x].style.left = (x * BLOCK_SIZE)+'px';

                dom.map_parent.appendChild( arr[x] );
            }
            
            dom.map.push( arr );
        }

    }


    function reset(){
        start = false;
        dom.ball.textContent = '';
        setMap( MapData.CLICK_START );

        clearTimeout( run_timer );
    }


    function getSquareBlock(x,y){
        x = Math.floor(x);
        y = Math.floor(y);
        if(y >= 0 && y < map.length && x >= 0 && x < map[y].length){
            return map[y].substr(x,1);
        }
        return ' ';
    }


    function run(){
        if(ball.moving){
            let x = Math.floor( ball.x / BLOCK_SIZE );
            let y = Math.floor( ball.y / BLOCK_SIZE );

            if(getSquareBlock(x,y+1) !== '*'){
                ball.vec_y += 0.4;
                if(ball.vec_y >= 7){
                    ball.vec_y = 7;
                }
            }

            if(ball.vec_y > 0 && getSquareBlock(x,y+1) === '*'){
                ball.vec_y *= -0.5;

                if(Math.abs( ball.vec_x ) <= 0.1 && Math.abs( ball.vec_y ) <= 0.3){
                    ball.moving = false;
                }
            }
            
            if(
                   (ball.vec_x > 0 && getSquareBlock(x+1,y) === '*')
                || (ball.vec_x < 0 && getSquareBlock(x-1,y) === '*')
            ){
                ball.vec_x *= -0.95;
            }

            if(getSquareBlock(x,y) === '.'){
                dom.clear.textContent = 'クリア★';
            }

            ball.vec_x *= 0.95;
            
            ball.x += ball.vec_x;
            ball.y += ball.vec_y;
        }else{
            let charge_spd = BALL_CHARGE_MAX / 30;
            if(ball.charging){
                ball.charge += charge_spd;
                if(ball.charge >= BALL_CHARGE_MAX){
                    ball.charge = BALL_CHARGE_MAX;
                    ball.charging = false;
                }
            }else{
                ball.charge -= charge_spd;
                if(ball.charge <= 0.3){
                    ball.charge = 0.3;
                    ball.charging = true;
                }
            }

            dom.ball_charge.textContent = (()=>{
                let sp = BALL_CHARGE_MAX / 10;
                let str = '';
                for(let i = 0; i * sp <= ball.charge; i++){
                    str += '*';
                }
                return str;
            })();
        }

        dom.ball.style.left = Math.floor( ball.x )+'px';
        dom.ball.style.top  = Math.floor( ball.y )+'px';

        run_timer = setTimeout( run ,32 );
    }


    createBase('trp10','trp_story_10','#d0ffd7',(inside)=>{
        if(!init){
            init = true;

            dom.ball = document.createElement('div');
            dom.ball.style.position = 'absolute';
            dom.ball.style.fontSize = '8px';
            
            inside.appendChild((()=>{
                dom.ball_charge = document.createElement('div');
                dom.ball_charge.textContent = '　';//dummy
                return dom.ball_charge;
            })());
            inside.appendChild((()=>{
                dom.map_parent = document.createElement('div');
                dom.map_parent.style.position = 'relative';

                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );

                return dom.map_parent;
            })());
            inside.appendChild((()=>{
                dom.clear = document.createElement('div');
                dom.clear.textContent = '　';//dummy
                return dom.clear;
            })());
            inside.appendChild((()=>{//背景確保用
                let div = document.createElement('div');
                for(let i = 0; i < 8; i++){
                    div.appendChild( document.createElement('br') );
                }

                return div;
            })());

            inside.addEventListener('click',()=>{
                if(!start){
                    start = true;

                    dom.ball.textContent = '@';
                    ball.x = 0;
                    ball.y = 0;
                    ball.vec_x = 0;
                    ball.vec_y = 0;
                    ball.charge = 0;
                    ball.moving = true;

                    dom.ball_charge.textContent = '　';

                    setMap( MapData.STAGE_0 );

                    run();
                    return;
                }


                if(!ball.moving){
                    ball.moving = true;
                    let rad = -Math.PI / 8;
                    ball.vec_x = Math.cos(rad) * ball.charge;
                    ball.vec_y = Math.sin(rad) * ball.charge;
                }
            });
        }

        reset();
    },(inside)=>{
        dom.clear.textContent = '　';
        clearTimeout( run_timer );
    });
}
</script>

<br>

<!-- trp11 -->
<script>
{   
    
    const MapData = {
        CLICK_START:[
                '',
                '',
                '',
                '',
                '',
                '',
                'C l i c k S t a r t',
                '',
                '',
                '',
                '',
                '',
                '',
        ],
        STAGE_0:[
                '                                                              ',
                '                                                              ',
                '                                  `                           ',
                '        *           *                                    <|   ',
                '        *           *                                     |  *',
                '********************************* ************************.***',
                '********************************* ****************************',
                '********************************* ****************************',
        ],
    };
    let init = false;

    let map = [];
    let dom = {
        map_parent:undefined,
        map:undefined,
        ball:undefined,
        ball_charge:undefined,
        clear:undefined,
    };

    let ball = {
        x:0.0,
        y:0.0,
        vec_x:0.0,
        vec_y:0.0,
        moving:false,
        charge:0.0,
        charging:false,
    };

    const BLOCK_SIZE = 8;
    const BALL_CHARGE_MAX = 20.0;
    const BALL_CHARGE_GAGE = '**********';

    let start = false;
    let run_timer;
    let tengu = -1;
    let run_count = 0;


    function resetMapDom(){
        while(dom.map_parent.firstChild){
            dom.map_parent.removeChild( dom.map_parent.firstChild );
        }

        dom.map_parent.appendChild( dom.ball );
    }

    function setMap(map_data){
        resetMapDom();

        map = map_data;

        dom.map = [];
        for(let y = 0; y < map.length; y++){
            let arr = [];
            for(let x = 0; x < map[y].length; x++){
                arr.push( document.createElement('div') );
                arr[x].textContent = map[y].substr(x,1);
                arr[x].style.position = 'absolute';
                arr[x].style.top  = (y * BLOCK_SIZE)+'px';
                arr[x].style.left = (x * BLOCK_SIZE)+'px';

                dom.map_parent.appendChild( arr[x] );
            }
            
            dom.map.push( arr );
        }

    }


    function reset(){
        start = false;
        dom.ball.textContent = '';
        setMap( MapData.CLICK_START );

        clearTimeout( run_timer );
    }


    function getSquareBlock(x,y){
        x = Math.floor(x);
        y = Math.floor(y);
        if(y >= 0 && y < map.length && x >= 0 && x < map[y].length){
            return map[y].substr(x,1);
        }
        return ' ';
    }


    function run(){
        run_count++;

        if(ball.moving){
            let x = Math.floor( ball.x / BLOCK_SIZE );
            let y = Math.floor( ball.y / BLOCK_SIZE );

            if(getSquareBlock(x,y+1) !== '*'){
                ball.vec_y += 0.4;
                if(ball.vec_y >= 7){
                    ball.vec_y = 7;
                }
            }

            if(ball.vec_y > 0 && getSquareBlock(x,y+1) === '*'){
                // ball.y = y * BLOCK_SIZE;
                ball.vec_y *= -0.3;

            }
            
            if(
                   (ball.vec_x > 0 && getSquareBlock(x+1,y) === '*')
                || (ball.vec_x < 0 && getSquareBlock(x-1,y) === '*')
            ){
                ball.vec_x *= -0.95;
            }

            if(getSquareBlock(x,y) === '`'){
                tengu = dom.map[0].length - 1;
                dom.map[y][x].textContent = ' ';
            }

            if(getSquareBlock(x,y) === '.'){
                dom.clear.textContent = 'クリア★';
            }

            ball.vec_x *= 0.95;
            
            ball.x += ball.vec_x;
            ball.y += ball.vec_y;
            
            if(Math.abs( ball.vec_x ) <= 0.1 && Math.abs( ball.vec_y ) <= 0.3){
                ball.moving = false;
            }
        }else{
            let charge_spd = BALL_CHARGE_MAX / 30;
            if(ball.charging){
                ball.charge += charge_spd;
                if(ball.charge >= BALL_CHARGE_MAX){
                    ball.charge = BALL_CHARGE_MAX;
                    ball.charging = false;
                }
            }else{
                ball.charge -= charge_spd;
                if(ball.charge <= 0){
                    ball.charge = 0;
                    ball.charging = true;
                }
            }

            dom.ball_charge.textContent = (()=>{
                let num = Math.floor( BALL_CHARGE_GAGE.length * ball.charge / BALL_CHARGE_MAX );
                if(num === 0){return '　';}
                return BALL_CHARGE_GAGE.substr(0,num);
            })();
        }

        dom.ball.style.left = Math.floor( ball.x )+'px';
        dom.ball.style.top  = Math.floor( ball.y )+'px';
        
        if(tengu >= 0 && run_count % 3 === 0){
            if(tengu < dom.map[0].length - 1){dom.map[0][tengu+1].textContent = ' ';}

            dom.map[0][tengu].textContent = '👺';

            tengu --;
            if(tengu < 0){
                dom.map[0][0].textContent = ' ';
            }
        }

        run_timer = setTimeout( run ,32 );
    }


    createBase('trp11','trp_story_11','#51d1c0',(inside)=>{
        if(!init){
            init = true;

            dom.ball = document.createElement('div');
            dom.ball.style.position = 'absolute';
            dom.ball.style.fontSize = '8px';
            
            inside.appendChild((()=>{
                dom.ball_charge = document.createElement('div');
                dom.ball_charge.textContent = '　';//dummy
                return dom.ball_charge;
            })());
            inside.appendChild((()=>{
                dom.map_parent = document.createElement('div');
                dom.map_parent.style.position = 'relative';

                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );
                dom.map_parent.appendChild( document.createElement('br') );

                return dom.map_parent;
            })());
            inside.appendChild((()=>{
                dom.clear = document.createElement('div');
                dom.clear.textContent = '　';//dummy
                return dom.clear;
            })());
            inside.appendChild((()=>{//背景確保用
                let div = document.createElement('div');
                for(let i = 0; i < 8; i++){
                    div.appendChild( document.createElement('br') );
                }

                return div;
            })());

            inside.addEventListener('click',()=>{
                if(!start){
                    start = true;

                    dom.ball.textContent = '@';
                    ball.x = 0;
                    ball.y = 0;
                    ball.vec_x = 0;
                    ball.vec_y = 0;
                    ball.charge = 0;
                    ball.moving = true;

                    dom.ball_charge.textContent = '　';

                    setMap( MapData.STAGE_0 );

                    run();
                    return;
                }


                if(!ball.moving){
                    ball.moving = true;
                    let rad = -Math.PI / 8;
                    ball.vec_x = Math.cos(rad) * ball.charge;
                    ball.vec_y = Math.sin(rad) * ball.charge;
                }
            });
        }

        reset();
    },(inside)=>{
        dom.clear.textContent = '　';
        clearTimeout( run_timer );
    });
}
</script>

<br>

<!-- trp12 -->
<script>
{
    let init = false;

    createBase('trp12','trp_story_12','#d6cdcd',(inside)=>{
        if(!init){
            init = true;
            
            inside.appendChild((()=>{
                let ret = document.createElement('div');
                ret.textContent = 'クリア★';
                ret.style.display = 'inline-block';
                ret.style.transform = 'rotate(10deg)';
                return ret;
            })());

        }

    },(inside)=>{
    });
}
</script>

<br>

<!-- trp13 -->
<script>
    {
        let init = false;
        let clear;
        let deg = 0;
        let run_timer;
    
        function run(){
            clear.style.transform = 'rotate('+deg+'deg)';
            deg += 25;
            run_timer = setTimeout( run ,36 );
        }
    
        createBase('trp13','trp_story_13','#ff9191',(inside)=>{
            if(!init){
                init = true;
                
                inside.appendChild((()=>{
                    clear = document.createElement('div');
                    clear.textContent = 'クリア★';
                    clear.style.display = 'inline-block';
                    clear.style.fontSize = '200%';
                    return clear;
                })());
    
            }
            
            run();
        },(inside)=>{
            clearTimeout( run_timer );
        });
    }
</script>

<br>

<!-- trp14 -->
<script>
    {
        const BACKGROUND_COLOR = '#c548ff';
        const START_SIZE = 30;
        let size = START_SIZE;

        let init = false;
        let center;
        let right;
        let clears = [];
        let run_timer;
        let mouse = {x:0,y:0};

        class Clear{
            constructor(){
                this.dom = undefined;
                this.x = 0.0;
                this.y = 0.0;
                let vec = 4;
                this.vec_x = -vec + Math.random() * vec * 2;
                this.vec_y = -0.1 - Math.random() * 3;
                this.shake = 0;
                this.shake_r = Math.random() * 4;
                this.shake_spd = Math.random() * 0.3;
            }

            setPos(x,y){
                this.x = x;
                this.y = y;

            }
        }

        function reset(){
            setBomSize( START_SIZE );
            center.textContent = '💣';
            clearClears();
        }

        function setBomSize(value){
            size = value;
            center.style.fontSize = size+'px';
            right.style.fontSize = size+'px';
        }

        function run(){
            for(let i = 0; i < clears.length; i++){
                let c = clears[i];

                c.x += c.vec_x;
                c.y += c.vec_y;

                let x = c.vec_y < 0 ? c.x : c.x + Math.sin( c.shake ) * c.shake_r;
                c.dom.style.left = x+'%';
                c.dom.style.top  = c.y+'%';

                c.vec_x *= 0.95;
                c.vec_y += 0.13;
                if(c.vec_y > 1){
                    c.vec_y = 1;
                }
                if(c.vec_y > 0){
                    c.shake += c.shake_spd;
                }
            }

            run_timer = setTimeout( run ,36 );
        }

        function clearClears(){
            for(let i = 0; i < clears.length; i++){
                document.body.removeChild( clears[i].dom );
            }

            clears = [];
        }
    
        createBase('trp14','trp_story_14',BACKGROUND_COLOR,(inside)=>{
            if(!init){
                init = true;
                
                inside.appendChild((()=>{
                    let lc = document.createElement('div');
                    lc.style.cssFloat = 'left';
                    lc.style.width = '67%';
                    lc.style.backgroundColor = BACKGROUND_COLOR;

                    lc.appendChild((()=>{
                        let left = document.createElement('div');
                        left.style.cssFloat = 'left';
                        left.style.width = '50%';
                        return left;
                    })());
                    lc.appendChild((()=>{
                        center = document.createElement('div');
                        center.style.cssFloat = 'right';
                        center.style.width = '50%';
                        center.style.textAlign = 'center';

                        center.addEventListener('click',()=>{
                            setBomSize( Math.floor( size * 1.1 + 1 ) );

                            if(size >= 200){
                                reset();
                                
                                for(let i = 0; i < 100; i++){
                                    let c = new Clear();
                                    c.dom = document.createElement('span');
                                    c.dom.textContent = 'クリア★';
                                    c.dom.style.position = 'fixed';
                                    c.dom.style.textAlign = 'center';
                                    c.x = Math.floor( mouse.x / window.innerWidth * 100 );
                                    c.y = Math.floor( mouse.y / window.innerHeight * 100 );

                                    // console.log(c.x+','+c.y);
                                    
                                    c.dom.style.left = c.x+'%';
                                    c.dom.style.top  = c.y+'%';

                                    clears.push( c );
                                    document.body.appendChild( c.dom );
                                }
                                
                                clearTimeout( run_timer );
                                run();
                            }
                        });
                        center.addEventListener('mousemove',(ev)=>{
                            mouse.x = ev.pageX;
                            mouse.y = ev.pageY;
                            // console.log('/');
                            // console.log( mouse.x+','+mouse.y );
                            // console.log( window.innerWidth+','+window.innerHeight );
                        });
                        return center;
                    })());
                    return lc;
                })());
                inside.appendChild((()=>{
                    right = document.createElement('div');
                    right.style.cssFloat = 'right';
                    right.style.width = '33%';
                    right.style.backgroundColor = BACKGROUND_COLOR;
                    right.textContent = '　';
                    return right;
                })());
            }


            reset();
        },(inside)=>{
            reset();
            
            clearTimeout( run_timer );
        });
    }
</script>

<br>

<!-- trp15 -->
<script>
    {
        const DUMMY_TEXT = '　';

        let init = false;
        let msg;
        let dom = {
            lv:undefined,
            job:undefined,
            job_mastered_num:undefined,
            item:undefined,
            msg:undefined,
            btn:{
                drill:undefined,
                job_change:undefined,
                boss:undefined,
            },
            achievements:undefined,
        };
        let prm = {
            hp:0,
            hp_max:0,
            lv:0,
            job:'しんまい',
            job_lv:{
                しんまい:0,
                戦士:0,
                魔法使い:0,
                スネイカー:0,
                イカ:0,
                タコ:0,
                たぬき:0,
                ダウザー:0,
                魔女:0,
                機械士:0,
                機械土:0,
                落ち武者:0,
                体術士:0,
                軍人:0,
                ヴァンパイア:0,
                蟹:0,
                月弓子:0,
                星士:0,
                ネクロマンサー:0,
                ちゅるほろ:0,
                ドンゴ:0,
                雷鳥:0,
                猫:0,
                有翼猫:0,
                黒き小人:0,
                フリーゲーム作家:0,
            },
            getJobLv:()=>prm.job_lv[ prm.job ],
        };
        let items = {
            石:false,
            岩:false,
            棒:false,
            少女の心を持ったおっさん:false,
            穴:false,
            うんち:false,
            地球:false,
            宇宙:false,
            土地:false,
            錆びたドッグタグ:false,
            ひゃくえん:false,
            ウンウンオクチウム:false,
        };
        
        const MAX_LV = 999;
        const MAX_JOB_LV = 10;
        const MAX_ITEM_NUM = Object.keys( items ).length;
        let all_job_mastered = false;
        let have_item_num = 0;

        function calcJobMasteredNum(){
            let job_keys = getJobKeys();
            let num = 0;
            for(let i = 0; i < job_keys.length; i++){
                if(prm.job_lv[ job_keys[i] ] >= MAX_JOB_LV){
                    num++;
                }
            }
            return num;
        }

        function getJobKeys(){
            return Object.keys( prm.job_lv );
        }

        function updateDom(){

            dom.lv.textContent = prm.lv >= MAX_LV
                                ? 'Lv:'+Math.floor( prm.lv )+'★'
                                : 'Lv:'+Math.floor( prm.lv );
                                ;
            dom.job.textContent = prm.getJobLv() >= MAX_JOB_LV
                                ? prm.job+'Lv:'+Math.floor( prm.getJobLv() )+'★'
                                : prm.job+'Lv:'+Math.floor( prm.getJobLv() )
                                ;
            dom.job_mastered_num.textContent = (()=>{
                let num = calcJobMasteredNum();
                let str = 'ジョブマスター数:'+num;
                if(num >= getJobKeys().length){
                    str += '★';
                }
                return str;
            })();
            dom.item.textContent = '所持アイテム数:'+have_item_num;
            if(have_item_num >= MAX_ITEM_NUM){
                dom.item.textContent += '★';
            }
            // dom.hp.textContent = 'HP:'+Math.floor( prm.hp )+'/'+Math.floor( prm.hp_max );
            {
                let ac = '';
                let count = 0;
                if(prm.lv >= MAX_LV){
                    count ++;
                    ac += '[阿修羅]';
                }
                if(calcJobMasteredNum() >= getJobKeys().length){
                    count ++;
                    ac += '[無職]';
                }
                if(have_item_num >= MAX_ITEM_NUM){
                    count ++;
                    ac += '[ゴミ屋敷]';
                }

                if(count >= 3){
                    ac += '[クリア★]';
                }
                
                if(ac === ''){
                    dom.achievements.textContent = DUMMY_TEXT;
                }else{
                    dom.achievements.textContent = ac;
                }
            }
        }

        createBase('trp15','trp_story_15','#9cbda1',(inside)=>{
            if(!init){
                init = true;

                function createBtn(name ,click){
                    let btn = document.createElement('span');
                    btn.textContent = name;
                    btn.style.cursor = 'pointer';
                    btn.style.textDecoration = 'underline';
                    btn.addEventListener('click',()=>{
                        click();
                    });
                    return btn;
                }

                inside.appendChild((()=>{
                    dom.lv = document.createElement('div');
                    dom.lv.textContent = DUMMY_TEXT;
                    return dom.lv;
                })());
                inside.appendChild((()=>{
                    dom.job = document.createElement('div');
                    dom.job.textContent = DUMMY_TEXT;
                    return dom.job;
                })());
                inside.appendChild((()=>{
                    dom.job_mastered_num = document.createElement('div');
                    dom.job_mastered_num.textContent = DUMMY_TEXT;
                    return dom.job_mastered_num;
                })());
                inside.appendChild((()=>{
                    dom.item = document.createElement('div');
                    dom.item.textContent = DUMMY_TEXT;
                    return dom.item;
                })());
                inside.appendChild((()=>{
                    dom.achievements = document.createElement('div');
                    dom.achievements.textContent = DUMMY_TEXT;
                    return dom.achievements;
                })());
                inside.appendChild((()=>{
                    dom.msg = document.createElement('div');
                    dom.msg.textContent = DUMMY_TEXT;
                    return dom.msg;
                })());
                
                inside.appendChild((()=>{
                    let parent = document.createElement('div');
                    parent.appendChild(dom.btn.drill = createBtn('・戦う',()=>{
                        if(prm.lv < MAX_LV){
                            prm.lv++;
                        }

                        if(prm.getJobLv() < MAX_JOB_LV){
                            prm.job_lv[ prm.job ] ++;
                            prm.lv++;
                        }

                        if(have_item_num < MAX_ITEM_NUM && Math.random() <= 0.05){
                            let item_keys = Object.keys( items );
                            let index = Math.floor( Math.random() * item_keys.length );
                            let key = item_keys[index];
                            if(!items[ key ]){
                                items[ key ] = true;
                                have_item_num++;

                                dom.msg.textContent = '\"'+key+'\"を手に入れた';

                                prm.lv += 15;
                            };
                        }

                        if(prm.lv >= MAX_LV){
                            prm.lv = MAX_LV;
                        }

                        updateDom();
                    }));
                    return parent;
                })());
                inside.appendChild((()=>{
                    let parent = document.createElement('div');
                    parent.appendChild(dom.btn.job_change = createBtn('・転職',()=>{
                        let jobs = Object.keys( prm.job_lv );
                        let i_want_to_change_to_this_job = undefined;

                        if(Math.random() <= 0.3){
                            for(let i = 0; i < jobs.length; i++){
                                if(prm.job_lv[ jobs[i] ] < MAX_JOB_LV){
                                    i_want_to_change_to_this_job = jobs[i];
                                    break;            
                                }
                            }
                        }

                        if(i_want_to_change_to_this_job){
                            prm.job = i_want_to_change_to_this_job;
                        }else{
                            let index = Math.floor( Math.random() * jobs.length );
                            prm.job = jobs[index];
                        }

                        updateDom();
                    }));
                    return parent;
                })());

            }
            
            updateDom();

        },(inside)=>{
        });
    }
</script>

<br>

<span style="color:#9cbda1;"></span>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

</body>

</html>